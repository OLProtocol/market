(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9849],{74928:function(e,t,s){Promise.resolve().then(s.bind(s,82023))},82023:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var r=s(57437),a=s(57303),l=s(34191),i=s(15714),n=s(53726),o=s(12786),c=s(1271),u=s(87586),f=s(65647),d=s(2265),m=s(14498),x=s(69077),g=s(24842),h=s(90089),p=s(18182);function b(){let{t:e}=(0,h.$G)(),[t,s]=(0,d.useState)(!1),{list:b,remove:w}=(0,f.JU)(),{feeRate:_}=(0,f.Ee)(),{getUnspendUtxos:N}=(0,f.YL)(),[v,j]=(0,d.useState)("single"),{network:y,btcWallet:S,address:k}=(0,g.$)(e=>e),[C,P]=(0,d.useState)(""),[E,Z]=(0,d.useState)(""),[A,L]=(0,d.useState)(!1),[U,O]=(0,d.useState)(),[G,K]=(0,d.useState)(0),[Y,$]=(0,d.useState)("");console.log("app.account.sell.page: list: ",b);let B=t=>{for(let s of t)if(!(0,m.Sd)(s,y))return Z(e("pages.inscribe.step_three.error_3")),!1;return!0};(0,d.useMemo)(()=>"single"===v?Array.from({length:b.length}).fill(C.trim()).filter(e=>!!e):Y.split("\n").map(e=>e.trim()).filter(e=>""!==e),[Y,C,v,b]);let F=async()=>{s(!0),O(void 0);let[t,r]=await (0,p.vU)(u.lI.getAllUtxos)({address:k,network:y});if(t){console.error("Get utxo failed",t),c.ZP.error({message:e("notification.system_error")}),s(!1);return}let a=r.otherutxos.map(e=>({...e,utxo:"".concat(e.txid,":").concat(e.vout)})),l=r.plainutxos;console.log(C);let i=[C];if(0===i.length){Z(e("pages.transfer.error_1")),s(!1);return}if(B(i))try{let e=await (0,x.ZN)({inscriptionUtxos:a,addresses:i,network:y,oneOutput:A,utxos:l,feeRate:_.value});console.log(e);let t=await e.calNetworkFee();K(t),O(e)}catch(t){console.error("List failed",t),c.ZP.error({message:e("notification.transfer_error_title"),description:t.message})}finally{s(!1)}},H=async()=>{s(!0);try{if(!U)throw Error("No transaction");if(!S)throw Error("No wallet connected");let t=await S.signPsbt(U.toPsbt().toHex());t&&await S.pushPsbt(t),c.ZP.success({message:e("notification.transfer_success_title")})}catch(t){console.error("Confirm failed",t),c.ZP.error({message:e("notification.transfer_error_title"),description:t.message})}finally{s(!1)}};return(0,r.jsxs)("div",{className:"py-2 max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-between gap-4 mb-4",children:[(0,r.jsx)("div",{className:"flex-1 mb-2 md:mb-0"}),(0,r.jsx)("div",{className:"max-w-full",children:(0,r.jsx)(a.n,{"aria-label":"address tabs",className:"w-full",selectedKey:v,onSelectionChange:e=>j(e),children:(0,r.jsx)(l.r,{title:e("pages.inscribe.step_three.to_single"),children:(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{children:(0,r.jsx)(i.Y,{placeholder:"Basic usage",value:C,onChange:e=>P(e.target.value)})}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(n.K,{isSelected:A,onValueChange:e=>L(e),children:"合并到一个utxo"})})]})},"single")})})]}),!!E&&(0,r.jsx)("div",{className:"text-red-500 text-center mb-4",children:E}),U?(0,r.jsxs)(o.A,{color:"primary",isLoading:t,className:"mx-auto max-w-full w-56 block",onClick:H,children:["确认（gas费用：",G," sat）"]}):(0,r.jsx)(o.A,{color:"primary",isLoading:t,className:"mx-auto max-w-full w-56 block",onClick:F,children:"转移所有资产"})]})}}},function(e){e.O(0,[3121,1866,1645,8218,2909,1277,1271,9710,9003,3726,8411,5274,3582,8974,4736,2971,7023,1744],function(){return e(e.s=74928)}),_N_E=e.O()}]);