(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1205],{72994:function(e,s,t){Promise.resolve().then(t.bind(t,96966))},96966:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return E}});var a=t(57437),i=t(24112),n=t(40884),l=t(75945),r=t(55448),u=t(68937),c=t(90089),o=t(2265),d=t(52975),m=t(46807),x=t(24842),f=t(65647),v=t(65703),p=t(59430),h=t(1271),g=t(90720),j=t(18334),b=t(8127),N=t(62121);function y(e){let{inputList:s,tickerList:t,handleTickerSelectChange:i,handleUtxoSelectChange:n,setInputList:l,loading:r}=e,{t:u}=(0,c.$G)(),[d,m]=(0,o.useState)({}),x=()=>{let e=(null==t?void 0:t.map(e=>e.ticker))||[],a=s.items.length+1;l("items",[...s.items,{id:a,value:{ticker:"",utxo:"",sats:0,unit:"sats"},options:{tickers:e,utxos:[]}}])},f=e=>{if(s.items.length>1){let t=s.items.filter(s=>s.id!==e);t.forEach((e,s)=>{e.id=s+1}),l("items",t)}},v=(e,t)=>{let a=t.target.value;s.items[e-1].value.unit=a,l("items",s.items)},h=async(e,s)=>{m(s=>({...s,[e]:!0})),await i(e,s),m(s=>({...s,[e]:!1}))};return console.log("inputList",s),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h2",{className:"text-base sm:text-lg font-semibold",children:[u("pages.tools.transaction.input")," UTXO"]}),(0,a.jsx)("div",{className:"space-y-3 sm:space-y-4",children:s.items.map((e,i)=>{var l,u,c;return(0,a.jsxs)("div",{className:"border border-divider bg-content1 p-2 sm:p-3 rounded-lg space-y-2 sm:space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm sm:text-base font-medium",children:["Input ",i+1]}),(0,a.jsxs)("div",{className:"flex space-x-1 sm:space-x-2",children:[(0,a.jsx)(g.A,{size:"sm",color:"primary",variant:"flat",onClick:x,className:"min-w-[24px] sm:min-w-[32px] h-6 sm:h-8 px-1 sm:px-2",children:"+"}),(0,a.jsx)(g.A,{size:"sm",color:"danger",variant:"flat",onClick:()=>f(e.id),className:"min-w-[24px] sm:min-w-[32px] h-6 sm:h-8 px-1 sm:px-2",isDisabled:1===s.items.length,children:"-"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:gap-3",children:[(0,a.jsx)(j.g,{label:"Ticker",placeholder:"Select Ticker",size:"sm",className:"w-full",selectedKeys:(null===(l=e.value)||void 0===l?void 0:l.ticker)?[e.value.ticker]:[],onChange:s=>h(e.id,s.target.value),isLoading:d[e.id]||r,children:null==t?void 0:t.map(e=>(0,a.jsx)(b.R,{value:e.ticker,children:(0,p.t2)(e.ticker)},e.ticker))}),(0,a.jsx)(j.g,{label:"UTXO",placeholder:"Select UTXO",size:"sm",className:"w-full",selectedKeys:(null===(u=e.value)||void 0===u?void 0:u.utxo)?[e.value.utxo]:[],onChange:s=>n(e.id,s.target.value),isLoading:d[e.id]||r,children:null===(c=e.options)||void 0===c?void 0:c.utxos.map(e=>(0,a.jsx)(b.R,{textValue:e.txid+":"+e.vout,children:(0,a.jsxs)("div",{className:"truncate text-xs sm:text-sm",children:[e.assetamount&&e.assetamount+" Asset/",e.value+" sats - "+(0,p.NH)(e.txid+":"+e.vout)]})},e.txid+":"+e.vout))}),(0,a.jsx)(N.Y,{type:"number",label:"Amount",placeholder:"0",size:"sm",readOnly:!0,className:"w-full",value:"sats"===e.value.unit?e.value.sats:e.value.sats/1e8,endContent:(0,a.jsxs)(j.g,{"aria-label":"Select unit",size:"sm",className:"w-24 sm:w-32 min-w-max",selectedKeys:[e.value.unit],onChange:s=>v(e.id,s),children:[(0,a.jsx)(b.R,{value:"sats",children:"sats"},"sats"),(0,a.jsx)(b.R,{value:"btc",children:"btc"},"btc")]})})]})]},i)})})]})}var w=t(32897);function k(e){let{outputList:s,setOutputList:t,address:i}=e,{t:n}=(0,c.$G)(),l=()=>{let e=s.items.length+1;t("items",[...s.items,{id:e,num:1,value:{sats:0,unit:"sats",address:""}}])},r=e=>{if(s.items.length>1){let a=s.items.filter(s=>s.id!==e);a.forEach((e,s)=>{e.id=s+1}),t("items",a)}},u=(e,a)=>{s.items[e-1].value.address=a,t("items",s.items)},o=(e,a)=>{console.log(a),"sats"===s.items[e-1].value.unit?s.items[e-1].value.sats=Number(a):s.items[e-1].value.sats=1e8*Number(a),t("items",s.items)},d=(e,a)=>{console.log(Number(a)),s.items[e-1].num=Number(a),t("items",s.items)},m=(e,a)=>{let i=a.target.value;s.items[e-1].value.unit=i,t("items",s.items)};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("h2",{className:"text-base sm:text-lg font-semibold",children:[n("pages.tools.transaction.output")," UTXO"]}),(0,a.jsx)("div",{className:"space-y-3 sm:space-y-4",children:s.items.map((e,t)=>{var n;return(0,a.jsxs)("div",{className:"border border-divider bg-content1 p-2 sm:p-3 rounded-lg space-y-2 sm:space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm sm:text-base font-medium",children:["Output ",t+1]}),(0,a.jsxs)("div",{className:"flex space-x-1 sm:space-x-2",children:[(0,a.jsx)(N.Y,{type:"number",placeholder:"0",size:"sm",className:"w-20",value:null===(n=e.num)||void 0===n?void 0:n.toString(),onChange:s=>d(e.id,s.target.value)}),(0,a.jsx)(g.A,{size:"sm",color:"primary",variant:"flat",onClick:l,className:"min-w-[24px] sm:min-w-[32px] h-6 sm:h-8 px-1 sm:px-2",children:"+"}),(0,a.jsx)(g.A,{size:"sm",color:"danger",variant:"flat",onClick:()=>r(e.id),className:"min-w-[24px] sm:min-w-[32px] h-6 sm:h-8 px-1 sm:px-2",isDisabled:1===s.items.length,children:"-"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:gap-3",children:[(0,a.jsx)(N.Y,{label:"BTC Address",placeholder:"Enter BTC Address",size:"sm",value:e.value.address,onChange:s=>u(e.id,s.target.value),className:"w-full",endContent:(0,a.jsx)(w.e,{content:"Fill the BTC address of the current account",children:(0,a.jsx)(g.A,{size:"sm",variant:"flat",onClick:()=>u(e.id,i),className:"px-1 sm:px-2 min-w-[40px] sm:min-w-[60px]",children:"Copy"})})}),(0,a.jsx)(N.Y,{type:"number",label:"Amount",placeholder:"0",size:"sm",className:"w-full",value:"sats"===e.value.unit?e.value.sats:e.value.sats/1e8,onChange:s=>o(e.id,s.target.value),endContent:(0,a.jsxs)(j.g,{"aria-label":"Select unit",size:"sm",className:"w-24 sm:w-32 min-w-max",selectedKeys:[e.value.unit],onChange:s=>m(e.id,s),children:[(0,a.jsx)(b.R,{value:"sats",children:"sats"},"sats"),(0,a.jsx)(b.R,{value:"btc",children:"btc"},"btc")]})})]})]},t)})})]})}function C(e){let{balance:s,setBalance:t,address:i}=e,{t:n}=(0,c.$G)(),l=e=>{t("unit",e.target.value)};return(0,a.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)("h2",{className:"text-base sm:text-lg font-semibold",children:n("pages.tools.transaction.balance")}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm text-gray-400",children:["(",n("pages.tools.transaction.balance_des"),")"]})]}),(0,a.jsxs)("div",{className:"border border-divider bg-content1 p-2 sm:p-3 rounded-lg  space-y-2 sm:space-y-3",children:[(0,a.jsx)(N.Y,{label:"Current Address",value:i,readOnly:!0,size:"sm",className:"w-full"}),(0,a.jsx)(N.Y,{type:"number",label:"Balance",placeholder:"0",size:"sm",value:"sats"===s.unit?s.sats:s.sats/1e8,className:"w-full",endContent:(0,a.jsxs)(j.g,{"aria-label":"Select unit",size:"sm",className:"w-24 sm:w-32 min-w-max",selectedKeys:[s.unit],onChange:e=>l(e),children:[(0,a.jsx)(b.R,{value:"sats",children:"sats"},"sats"),(0,a.jsx)(b.R,{value:"btc",children:"btc"},"btc")]})})]})]})}var _=t(27517);function A(e){let{loading:s,splitHandler:t,fee:i,feeRate:n}=e,{t:l}=(0,c.$G)();return(0,a.jsxs)("div",{className:"flex flex-col items-center w-full space-y-2 sm:space-y-3",children:[(0,a.jsx)(_.j,{className:"w-full",children:(0,a.jsx)(g.A,{color:"primary",onClick:t,isLoading:s,className:"w-full sm:w-auto",size:"sm",children:l("pages.tools.transaction.btn_send")})}),(0,a.jsxs)("div",{className:"text-xs sm:text-sm text-gray-400 text-center",children:[(0,a.jsxs)("p",{children:[l("pages.tools.transaction.network_fee"),": ",i," sats"]}),(0,a.jsxs)("p",{children:[n.value," sat/vb"]})]})]})}function E(){let{t:e}=(0,c.$G)(),{fee:s,loading:t,address:g,inputList:j,outputList:b,balance:N,tickerList:w,handleTickerSelectChange:_,handleUtxoSelectChange:E,setInputList:z,setOutputList:R,setBalance:S,splitHandler:O,feeRate:L}=function(){let{t:e}=(0,c.$G)(),[s,t]=(0,o.useState)(0),{feeRate:a}=(0,f.Ee)(e=>e),[i,n]=(0,o.useState)(!1),{address:l,network:r,publicKey:u}=(0,x.$)(e=>e),[g,j]=(0,o.useState)(0),[b,N]=(0,o.useState)(100),[y,w]=(0,o.useState)(100),[k,{set:C}]=(0,d.Z)({items:[{id:1,value:{ticker:"",utxo:"",sats:0,unit:"sats",description:""},options:{tickers:[],utxos:[]}}]}),[_,{set:A}]=(0,d.Z)({items:[{id:1,num:1,value:{sats:0,unit:"sats",address:""}}]}),[E,{set:z}]=(0,d.Z)({sats:0,unit:"sats"}),[R,{set:S}]=(0,m.Z)([]),O=(0,o.useCallback)((e,s)=>{let t=[...k.items];t[e-1].value={...t[e-1].value,ticker:s,sats:0,unit:"sats",utxo:"",utxos:[]};let a=((null==R?void 0:R.find(e=>e.ticker===s))||[]).utxos;k.items.length>1&&k.items.forEach((s,t)=>{t!==e-1&&(a=[...new Set(a=a.filter(e=>e.txid+":"+e.vout!==s.value.utxo))])}),t[e-1].options.utxos=a,C("items",t)},[k.items,R]),L=(0,o.useCallback)((e,s)=>{let t=s.split(":")[0],a=Number(s.split(":")[1]),i=k.items[e-1].options.utxos.find(e=>e.txid===t&&e.vout===a),n=[...k.items];n[e-1].value={...n[e-1].value,sats:(null==i?void 0:i.value)||0,utxo:s,description:(null==i?void 0:i.assetamount)?"".concat(i.assetamount," Asset/ ").concat(i.value," sats"):"".concat(i.value," sats")},C("items",n),T()},[k.items]),T=(0,o.useCallback)(async()=>{let e=0,s=0;if(k.items.forEach(s=>{e+=s.value.sats}),0===e)return;let i=[];if(_.items.forEach(e=>{for(let s=0;s<e.num;s++)i.push({address:e.value.address,value:e.value.sats})}),i.forEach(e=>{s+=e.value}),0===s)return;let n=k.items.map(e=>({txid:e.value.utxo.split(":")[0],vout:Number(e.value.utxo.split(":")[1]),value:e.value.sats})),c=await (0,p.QV)({utxos:n,outputs:i,feeRate:a.value,network:r,address:l,publicKey:u});t(c),z("sats",e-s-c)},[k.items,_.items,a.value,r,l,u]),Z=(0,o.useCallback)(async()=>{let s=[],t=await (0,v.zO)({address:l,network:r});if(0!==t.code){h.ZP.error({message:e("notification.transaction_title"),description:t.msg});return}let a=t.data.detail;return await Promise.all(a.map(async e=>{if("e"===e.type||"o"===e.type)return;let a=e.type;"f"===e.type&&(a=e.ticker);let i=[],n=0;if(0===(t=await (0,v.Rw)({start:0,limit:b,address:l,tickerOrAssetsType:a,network:r})).code){let e=t.data.detail;n=t.data.total,e.forEach(e=>{let s={txid:e.utxo.split(":")[0],vout:Number(e.utxo.split(":")[1]),value:e.amount,assetamount:e.assetamount};i.push(s)})}s.push({ticker:e.ticker,total:n,utxos:i})})),s},[l,r,b,e]),G=(0,o.useCallback)(async()=>{let s=await (0,v.wt)({address:l,value:0,network:r});if(0!==s.code){h.ZP.error({message:e("notification.transaction_title"),description:s.msg});return}return{ticker:e("pages.tools.transaction.available_utxo"),utxos:s.data}},[l,r,e]),$=(0,o.useCallback)(async()=>{let s=await (0,v.bA)({address:l,network:r}),t=[];return 0===s.code&&s.data.forEach(s=>{let a=!1;if(s.sats&&s.sats.length>0&&s.sats.forEach(e=>{if(e.satributes&&e.satributes.length>0){a=!0;return}}),a){let a={txid:s.utxo.split(":")[0],vout:Number(s.utxo.split(":")[1]),value:s.value};if(0===t.length)t.push({ticker:e("pages.tools.transaction.rare_sats")+"-"+s.sats[0].satributes[0],utxos:[a]});else{let i=!1;t.forEach(e=>{e.utxos.forEach(e=>{if(e===a.txid+":"+a.vout){i=!0;return}})}),i||(t.some(t=>t.ticker===e("pages.tools.transaction.rare_sats")+"-"+s.sats[0].satributes[0])?t=t.map(t=>t.ticker===e("pages.tools.transaction.rare_sats")+"-"+s.sats[0].satributes[0]?{ticker:t.ticker,utxos:[...t.utxos,a]}:t):t.push({ticker:e("pages.tools.transaction.rare_sats")+"-"+s.sats[0].satributes[0],utxos:[a]}))}}}),t},[l,r,e]),P=(0,o.useCallback)(async()=>{let e=await Z(),s=await G();null==e||e.push(s);let t=await $();S((null==e?void 0:e.concat(t))||[])},[Z,G,$]),U=(0,o.useCallback)(async()=>{if(l){n(!0);try{let s=k.items.reduce((e,s)=>e+s.value.sats,0),t=k.items.map(e=>({txid:e.value.utxo.split(":")[0],vout:Number(e.value.utxo.split(":")[1]),value:e.value.sats})),i=[];_.items.forEach(e=>{for(let s=0;s<e.num;s++)i.push({address:e.value.address,value:e.value.sats})});let c=i.reduce((e,s)=>e+s.value,0),o=await (0,p.QV)({utxos:t,outputs:i,feeRate:a.value,network:r,address:l,publicKey:u});if(s-c-o<0){n(!1),h.ZP.error({message:e("notification.transaction_title"),description:"Not enough sats"});return}let d=await (0,p.cq)({utxos:t,outputs:i,feeRate:a.value,network:r,address:l,suitable:!1,publicKey:u});await (0,p.hw)(d),n(!1),h.ZP.success({message:e("notification.transaction_title"),description:e("notification.transaction_spilt_success")}),j(e=>e+1)}catch(s){console.log("error(transfer sats) = ",s),n(!1),h.ZP.error({message:e("notification.transaction_title"),description:s.message||e("notification.transaction_spilt_fail")})}}},[l,k.items,_.items,a.value,r,u,e]);return(0,o.useEffect)(()=>{T()},[a,k,_]),(0,o.useEffect)(()=>{S([]),C("items",[{id:1,value:{ticker:"",utxo:"",sats:0,unit:"sats"},options:{tickers:[],utxos:[]}}]),z("sats",0),z("unit","sats"),t(0),A("items",[{id:1,num:1,value:{sats:0,unit:"sats",address:""}}]),l&&P()},[l,g,P]),(0,o.useMemo)(()=>({fee:s,loading:i,address:l,inputList:k,outputList:_,balance:E,tickerList:R,handleTickerSelectChange:O,handleUtxoSelectChange:L,setInputList:C,setOutputList:A,setBalance:z,splitHandler:U,refresh:g,feeRate:a}),[s,i,l,k,_,E,R,O,L,U,g,a])}();return(0,a.jsx)("div",{className:"flex flex-col w-full max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 py-2 sm:py-4 lg:py-6",children:(0,a.jsxs)(i.w,{className:"w-full",children:[(0,a.jsx)(n.u,{className:"flex flex-col items-start p-3 sm:p-4",children:(0,a.jsx)("h1",{className:"text-lg sm:text-xl font-bold uppercase",children:e("pages.tools.transaction.title")})}),(0,a.jsx)(l.j,{}),(0,a.jsx)(r.G,{className:"p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsx)(y,{loading:t,inputList:j,tickerList:w,handleTickerSelectChange:_,handleUtxoSelectChange:E,setInputList:z}),(0,a.jsx)(l.j,{}),(0,a.jsx)(k,{outputList:b,setOutputList:R,address:g}),(0,a.jsx)(l.j,{}),(0,a.jsx)(C,{balance:N,setBalance:S,address:g})]})}),(0,a.jsx)(l.j,{}),(0,a.jsx)(u.i,{className:"flex flex-col items-center p-3 sm:p-4",children:(0,a.jsx)(A,{loading:t,splitHandler:O,fee:s,feeRate:L})})]})})}},27517:function(e,s,t){"use strict";t.d(s,{j:function(){return r}});var a=t(57437),i=t(90720),n=t(24842);t(2265);var l=t(90089);let r=e=>{var s;let{children:t,className:r,text:u,keepStyle:c}=e;null==t||null===(s=t.props)||void 0===s||s.onClick;let{t:o}=(0,l.$G)(),{connected:d,setModalVisible:m}=(0,n.$)(e=>e);return d||c?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.A,{variant:"ghost",size:"md",onClick:()=>m(!0),radius:"sm",className:r,color:"primary",children:u||o("buttons.connect")})})}},46807:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});var a=t(2265),i=function(e){return(e+1)%1e6};function n(e,s){return"function"==typeof e?e.length?e(s):e():e}var l=function(e){void 0===e&&(e=[]);var s=(0,a.useRef)(n(e)),t=(0,a.useReducer)(i,0)[1],l=(0,a.useMemo)(function(){var a={set:function(e){s.current=n(e,s.current),t()},push:function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];e.length&&l.set(function(s){return s.concat(e)})},updateAt:function(e,s){l.set(function(t){var a=t.slice();return a[e]=s,a})},insertAt:function(e,s){l.set(function(t){var a=t.slice();return e>a.length?a[e]=s:a.splice(e,0,s),a})},update:function(e,s){l.set(function(t){return t.map(function(t){return e(t,s)?s:t})})},updateFirst:function(e,t){var a=s.current.findIndex(function(s){return e(s,t)});a>=0&&l.updateAt(a,t)},upsert:function(e,t){var a=s.current.findIndex(function(s){return e(s,t)});a>=0?l.updateAt(a,t):l.push(t)},sort:function(e){l.set(function(s){return s.slice().sort(e)})},filter:function(e,s){l.set(function(t){return t.slice().filter(e,s)})},removeAt:function(e){l.set(function(s){var t=s.slice();return t.splice(e,1),t})},clear:function(){l.set([])},reset:function(){l.set(n(e).slice())}};return a.remove=a.removeAt,a},[]);return[s.current,l]}},52975:function(e,s,t){"use strict";var a=t(11735),i=t(2265);s.Z=function(e){void 0===e&&(e={});var s=(0,i.useState)(e),t=s[0],n=s[1],l=(0,i.useMemo)(function(){return{set:function(e,s){n(function(t){var i;return(0,a.__assign)((0,a.__assign)({},t),((i={})[e]=s,i))})},setAll:function(e){n(e)},remove:function(e){n(function(s){return s[e],(0,a.__rest)(s,["symbol"==typeof e?e:e+""])})},reset:function(){return n(e)}}},[n]),r=(0,a.__assign)({get:(0,i.useCallback)(function(e){return t[e]},[t])},l);return[t,r]}},40884:function(e,s,t){"use strict";t.d(s,{u:function(){return c}});var a=t(66265),i=t(62957),n=t(26242),l=t(65263),r=t(57437),u=(0,i.Gp)((e,s)=>{var t;let{as:i,className:u,children:c,...o}=e,d=(0,n.gy)(s),{slots:m,classNames:x}=(0,a.R)(),f=(0,l.W)(null==x?void 0:x.header,u);return(0,r.jsx)(i||"div",{ref:d,className:null==(t=m.header)?void 0:t.call(m,{class:f}),...o,children:c})});u.displayName="NextUI.CardHeader";var c=u},68937:function(e,s,t){"use strict";t.d(s,{i:function(){return c}});var a=t(66265),i=t(62957),n=t(26242),l=t(65263),r=t(57437),u=(0,i.Gp)((e,s)=>{var t;let{as:i,className:u,children:c,...o}=e,d=(0,n.gy)(s),{slots:m,classNames:x}=(0,a.R)(),f=(0,l.W)(null==x?void 0:x.footer,u);return(0,r.jsx)(i||"div",{ref:d,className:null==(t=m.footer)?void 0:t.call(m,{class:f}),...o,children:c})});u.displayName="NextUI.CardFooter";var c=u},12246:function(e,s,t){"use strict";t.d(s,{v:function(){return i}});var a=t(57437),i=({strokeWidth:e=1.5,...s})=>(0,a.jsx)("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:e,viewBox:"0 0 24 24",width:"1em",...s,children:(0,a.jsx)("path",{d:"m6 9 6 6 6-6"})})},52897:function(e,s,t){"use strict";function a(e,s){return"function"==typeof s.getChildren?s.getChildren(e.key):e.childNodes}function i(e){return n(e,0)}function n(e,s){if(s<0)return;let t=0;for(let a of e){if(t===s)return a;t++}}function l(e){let s;for(let t of e)s=t;return s}t.d(s,{Em:function(){return n},_P:function(){return a},l8:function(){return i},s:function(){return l}})}},function(e){e.O(0,[3121,1866,1645,8218,5041,5298,1271,666,6425,4242,2897,758,4800,787,1447,2971,7023,1744],function(){return e(e.s=72994)}),_N_E=e.O()}]);