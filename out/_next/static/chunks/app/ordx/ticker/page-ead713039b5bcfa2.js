(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{3833:function(e,s,a){Promise.resolve().then(a.bind(a,54104))},54104:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return K}});var l=a(57437),r=a(42853),t=a(25677),n=a(23310),i=a(21507),o=a(62478),d=a(14511),c=a(89571),u=a(42272),m=a(46802),x=a(13479),h=a(48749),v=a(89860),f=a(2265),b=a(31197),g=a(28034),p=a(34480),j=a(12650),y=a(72609),w=a(26565),N=a(9040),C=a(56926),J=a(45506),_=(0,C.tv)({slots:{base:["relative","max-w-fit","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"flex-shrink-0",closeButton:["z-10","appearance-none","outline-none","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...J.jR,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:N.J.solid.default}},{variant:"solid",color:"primary",class:{base:N.J.solid.primary}},{variant:"solid",color:"secondary",class:{base:N.J.solid.secondary}},{variant:"solid",color:"success",class:{base:N.J.solid.success}},{variant:"solid",color:"warning",class:{base:N.J.solid.warning}},{variant:"solid",color:"danger",class:{base:N.J.solid.danger}},{variant:"shadow",color:"default",class:{base:N.J.shadow.default}},{variant:"shadow",color:"primary",class:{base:N.J.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:N.J.shadow.secondary}},{variant:"shadow",color:"success",class:{base:N.J.shadow.success}},{variant:"shadow",color:"warning",class:{base:N.J.shadow.warning}},{variant:"shadow",color:"danger",class:{base:N.J.shadow.danger}},{variant:"bordered",color:"default",class:{base:N.J.bordered.default}},{variant:"bordered",color:"primary",class:{base:N.J.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:N.J.bordered.secondary}},{variant:"bordered",color:"success",class:{base:N.J.bordered.success}},{variant:"bordered",color:"warning",class:{base:N.J.bordered.warning}},{variant:"bordered",color:"danger",class:{base:N.J.bordered.danger}},{variant:"flat",color:"default",class:{base:N.J.flat.default}},{variant:"flat",color:"primary",class:{base:N.J.flat.primary}},{variant:"flat",color:"secondary",class:{base:N.J.flat.secondary}},{variant:"flat",color:"success",class:{base:N.J.flat.success}},{variant:"flat",color:"warning",class:{base:N.J.flat.warning}},{variant:"flat",color:"danger",class:{base:N.J.flat.danger}},{variant:"faded",color:"default",class:{base:N.J.faded.default}},{variant:"faded",color:"primary",class:{base:N.J.faded.primary}},{variant:"faded",color:"secondary",class:{base:N.J.faded.secondary}},{variant:"faded",color:"success",class:{base:N.J.faded.success}},{variant:"faded",color:"warning",class:{base:N.J.faded.warning}},{variant:"faded",color:"danger",class:{base:N.J.faded.danger}},{variant:"light",color:"default",class:{base:N.J.light.default}},{variant:"light",color:"primary",class:{base:N.J.light.primary}},{variant:"light",color:"secondary",class:{base:N.J.light.secondary}},{variant:"light",color:"success",class:{base:N.J.light.success}},{variant:"light",color:"warning",class:{base:N.J.light.warning}},{variant:"light",color:"danger",class:{base:N.J.light.danger}},{isOneChar:!0,size:"sm",class:{base:"w-5 h-5 min-w-unit-5 min-h-5"}},{isOneChar:!0,size:"md",class:{base:"w-6 h-6 min-w-unit-6 min-h-6"}},{isOneChar:!0,size:"lg",class:{base:"w-7 h-7 min-w-unit-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,class:{base:"w-auto"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),k=a(25312),P=a(59762),M=a(28305),z=(0,p.Gp)((e,s)=>{let{Component:a,children:r,slots:t,classNames:n,isDot:i,isCloseable:o,startContent:d,endContent:c,getCloseButtonProps:u,getChipProps:m}=function(e){let[s,a]=(0,p.oe)(e,_.variantKeys),{ref:l,as:r,children:t,avatar:n,startContent:i,endContent:o,onClose:d,classNames:c,className:u,...m}=s,x=(0,k.gy)(l),h=(0,P.W)(null==c?void 0:c.base,u),v=!!d,b="dot"===e.variant,{focusProps:g,isFocusVisible:N}=(0,w.Fx)(),C=(0,f.useMemo)(()=>"string"==typeof t&&(null==t?void 0:t.length)===1,[t]),J=(0,f.useMemo)(()=>!!n||!!i,[n,i]),M=(0,f.useMemo)(()=>!!o||v,[o,v]),z=(0,f.useMemo)(()=>_({...a,hasStartContent:J,hasEndContent:M,isOneChar:C,isCloseable:v,isCloseButtonFocusVisible:N}),[...Object.values(a),N,J,M,C,v]),{pressProps:B}=(0,y.r)({isDisabled:!!(null==e?void 0:e.isDisabled),onPress:d}),O=e=>(0,f.isValidElement)(e)?(0,f.cloneElement)(e,{className:(0,P.W)("max-h-[80%]",e.props.className)}):null;return{Component:r||"div",children:t,slots:z,classNames:c,isDot:b,isCloseable:v,startContent:((0,f.isValidElement)(n)?(0,f.cloneElement)(n,{className:z.avatar({class:null==c?void 0:c.avatar})}):null)||O(i),endContent:O(o),getCloseButtonProps:()=>({role:"button",tabIndex:0,className:z.closeButton({class:null==c?void 0:c.closeButton}),...(0,j.dG)(B,g)}),getChipProps:()=>({ref:x,className:z.base({class:h}),...m})}}({...e,ref:s}),x=(0,f.useMemo)(()=>i&&!d?(0,l.jsx)("span",{className:t.dot({class:null==n?void 0:n.dot})}):d,[t,d,i]),h=(0,f.useMemo)(()=>o?(0,l.jsx)("span",{...u(),children:c||(0,l.jsx)(M.f,{})}):c,[c,o,u]);return(0,l.jsxs)(a,{...m(),children:[x,(0,l.jsx)("span",{className:t.content({class:null==n?void 0:n.content}),children:r}),h]})});z.displayName="NextUI.Chip";var B=a(12765),O=a(89324);let S=e=>{var s;let{item:a,onBuy:r}=e,[o,d]=(0,f.useState)(!1),c=async()=>{d(!0);try{await r(a)}catch(e){}finally{d(!1)}};return(0,l.jsxs)(n.w,{isPressable:!0,radius:"lg",className:"border-none w-full h-[14rem] md:h-[20rem]",children:[(0,l.jsx)(i.G,{children:(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsx)("div",{className:"flex-1 text-sm md:text-base",children:null==a?void 0:null===(s=a.assets)||void 0===s?void 0:s.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{children:["Ticker: ",e.ticker]}),(0,l.jsxs)("div",{children:["Amount: ",e.amount]})]},e.inscriptionnum))}),(0,l.jsx)(z,{size:"lg",className:"w-full max-w-none text-small",children:(0,l.jsxs)("div",{children:[null==a?void 0:a.price," BTC"]})})]})}),(0,l.jsx)(B.i,{className:"",children:(0,l.jsx)(O.j,{className:"flex-1",children:(0,l.jsx)(t.A,{className:"text-tiny flex-1 ",variant:"flat",isLoading:o,color:"default",radius:"lg",onClick:c,children:"购买"})})})]})};var Z=a(94318),A=a(91609),E=a(89369),T=a(61718),U=a(69571),R=a(27679),V=a(78507),F=a(2913),D=a(56690),G=a(87714);let I=e=>{var s;let{visiable:a,item:n,orderRaw:i,onClose:d,onSuccess:c}=e,u=0;u=Number("1000");let{feeRate:m}=(0,G.E)(e=>e),{balance:x,address:b,network:g}=(0,v.$)(e=>e),[p,j]=(0,f.useState)(!1),{isOpen:y,onOpen:w,onOpenChange:N,onClose:C}=(0,Z.q)(),{data:J,isLoading:_}=(0,r.ZP)("getUtxoByValue-".concat(b,"-").concat(g),()=>(0,o.wt)({address:b,network:g,value:500})),k=(0,f.useMemo)(()=>(null==J?void 0:J.data)||[],[J]),P=(0,f.useMemo)(()=>k.reduce((e,s)=>e+s.value,0),[k]),M=async()=>{j(!0);try{let e=await (0,o.n3)({address:b,order_id:n.order_id});if(200!==e.code){h.ZP.error({message:"Cancel order failed",description:e.msg});return}B()}catch(e){h.ZP.error({message:"Cancel order failed",description:e.message})}finally{j(!1)}},B=()=>{null==d||d(),C()},O=(0,f.useMemo)(()=>(null==n?void 0:n.price)?(0,D.g)(null==n?void 0:n.price):0,[null==n?void 0:n.price]),S=async()=>{try{var e,s;if(!(b&&g&&(null===(e=I.smallTwoUtxos)||void 0===e?void 0:e.length))){h.ZP.warning({message:"buy error",description:"数据错误"});return}if(!i){h.ZP.warning({message:"buy error",description:"Order Raw is empty"});return}if((null===(s=I.smallTwoUtxos)||void 0===s?void 0:s.length)<2){h.ZP.warning({message:"Buy error",description:"dummyUtxos lack of two utxos"});return}j(!0);let a=await (0,D.Us)({orderId:n.order_id,orderRaw:i,utxos:I.utxos,dummyUtxos:I.smallTwoUtxos,fee:I.fee,address:b,network:g,serviceFee:u,feeRate:m.value}),l=await (0,o.Hj)({order_id:null==n?void 0:n.order_id,address:b,raw:a});200===l.code?(h.ZP.success({message:"buy successfully",description:"The order has been submitted successfully, please wait for the buyer to buy it."}),null==c||c(),B()):h.ZP.error({message:"buy failed",description:l.msg})}catch(e){h.ZP.error({message:"buy failed",description:e.message})}finally{j(!1)}},I=(0,f.useMemo)(()=>{let e=890*m.value;if(!k.length||!O)return{fee:0,utxos:[]};let{utxos:s,smallTwoUtxos:a}=(0,D.zU)(k,e+330+O+u),l=(180*(s.length+4)+136+10)*m.value;return{fee:l,utxos:s,smallTwoUtxos:a}},[m,k,O,u]);console.log("networkFeeAndUtxos",I);let L=(0,f.useMemo)(()=>n?(0,D.g)(null==n?void 0:n.price)+u+I.fee:0,[n,u,I.fee]),$=(0,f.useMemo)(()=>P<L,[P,L]),H=(0,f.useMemo)(()=>$,[$]);return(0,f.useEffect)(()=>{a?w():C()},[a]),(0,l.jsx)(A.R,{hideCloseButton:!0,backdrop:"blur",isDismissable:!1,isOpen:y,onOpenChange:N,onClose:B,children:(0,l.jsxs)(E.A,{children:[(0,l.jsx)(T.k,{className:"",children:"立即购买"}),(0,l.jsxs)(U.I,{children:[(0,l.jsxs)("div",{className:"flex  justify-between",children:[(0,l.jsx)("div",{className:"flex-1",children:null==n?void 0:null===(s=n.assets)||void 0===s?void 0:s.map(e=>(0,l.jsx)("div",{children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"font-bold",children:["Ticker: ",e.ticker]}),(0,l.jsxs)("div",{className:"text-sm",children:["Amount: ",e.amount]})]})},e.inscriptionnum))}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{children:["价格: ",null==n?void 0:n.price," BTC"]}),(0,l.jsxs)("div",{className:"flex items-center",children:["来自:",(0,l.jsx)(R.Z,{codeString:null==n?void 0:n.address,className:"bg-transparent",symbol:"",size:"sm",variant:"flat",children:(0,D.NH)(null==n?void 0:n.address,4)})]})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{children:"Fee Rate"}),(0,l.jsxs)("div",{children:[m.value," ",(0,l.jsx)("span",{children:"sats"})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{children:"平台服务费"}),(0,l.jsxs)("div",{children:[u," ",(0,l.jsx)("span",{children:"sats"})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{children:"网络费用"}),_||!I.fee?(0,l.jsx)(V.c,{size:"sm"}):(0,l.jsxs)("div",{children:[I.fee," ",(0,l.jsx)("span",{children:"sats"})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center font-bold text-lg",children:[(0,l.jsx)("span",{children:"总计"}),(0,l.jsxs)("div",{children:[(0,D.Ay)(L)," ",(0,l.jsx)("span",{children:"BTC"})]})]}),(0,l.jsx)(z,{radius:"sm",size:"lg",className:"w-full max-w-none text-small",children:(0,l.jsxs)("div",{className:"flex items-center justify-between ".concat($?"text-red-600":""),children:[(0,l.jsx)("span",{children:"可用余额"}),_||!I.fee?(0,l.jsx)(V.c,{size:"sm"}):(0,l.jsxs)("span",{children:[(0,D.Ay)(P)," BTC"]})]})})]}),(0,l.jsxs)(F.R,{children:[(0,l.jsx)(t.A,{color:"danger",isLoading:p,variant:"light",onPress:M,children:"取消"}),(0,l.jsx)(t.A,{isLoading:p,isDisabled:H,color:"primary",onPress:S,children:"确认"})]})]})})};var L=a(24033);let $=e=>{let{ticker:s,address:a}=e;(0,L.useRouter)();let{address:t}=(0,v.$)(e=>e),[n,i]=(0,f.useState)(!1),[d,c]=(0,f.useState)(),[u,m]=(0,f.useState)(),[p,j]=(0,f.useState)(1),[y,w]=(0,f.useState)(10),N=(0,f.useMemo)(()=>a?"/ordx/getOrders-".concat(s,"-").concat(a,"-").concat(p,"-").concat(y):"/ordx/getOrders-".concat(s,"-").concat(p,"-").concat(y),[s,a,p,y]),{data:C,isLoading:J,mutate:_}=(0,r.ZP)(N,()=>(0,o.AU)({offset:(p-1)*y,size:y,ticker:s,address:a})),k=async e=>{var s;c(e);let a=await (0,o.xS)({address:t,order_id:e.order_id});if(!(null==a?void 0:null===(s=a.data)||void 0===s?void 0:s.raw)){h.ZP.error({message:"Lock order failed",description:a.msg});return}let{raw:l}=a.data;m(l),i(!0)},P=()=>{_(N)},M=(0,f.useMemo)(()=>{var e,s;return(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.total)?Math.ceil((null==C?void 0:null===(s=C.data)||void 0===s?void 0:s.total)/y):0},[C,y]),z=(0,f.useMemo)(()=>{var e;return(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.order_list)||[]},[C]);return(0,l.jsxs)("div",{className:"",children:[(0,l.jsxs)(g.V,{loading:J,children:[!z.length&&(0,l.jsx)(x.Z,{className:"mt-10"}),(0,l.jsx)("div",{className:"min-h-[30rem] grid  grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-4",children:z.map(e=>(0,l.jsx)(S,{item:e,onBuy:()=>k(e)},e.utxo))})]}),M>1&&(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)(b.t,{total:M,offset:p,size:y,onChange:(e,s)=>{j(e)}})}),!!u&&(0,l.jsx)(I,{item:d,orderRaw:u,onSuccess:()=>P(),onClose:()=>i(!1),visiable:n})]})};var H=a(41298);function K(){let e=(0,L.useRouter)(),s=(0,L.useSearchParams)(),{address:a}=(0,v.$)(e=>e),x=s.get("ticker"),{data:h}=(0,r.ZP)("getTickerSummary",()=>(0,o.RK)({ticker:x})),b=(0,f.useMemo)(()=>{var e;return(null==h?void 0:null===(e=h.data)||void 0===e?void 0:e.summary)||{}},[h]),g=(0,f.useMemo)(()=>[{value:b.tx_order_count,label:"总交易笔数"},{value:b.tx_total_amount,label:"Volume"},{value:b.tx_total_volume,label:"总成交额"},{value:b.onsell_order_count,label:"在售交易笔数"},{value:b.onsell_total_amount,label:"在售ordx的资产数量"},{value:b.lowest_price,label:"地板价"},{value:b.highest_price,label:"最高价"},{value:b.holder_count,label:"在售持有者数量"}],[b]);return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"min-h-40 flex flex-col py-2",children:[(0,l.jsxs)("div",{className:"flex-1 flex items-center mb-4 justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-1 items-center flex-wrap",children:[(0,l.jsx)(d.J,{src:"/logo.jpg",alt:"logo",className:"mr-2 w-16 h-16"}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("div",{className:"text-2xl md:text-4xl font-bold",children:null==b?void 0:b.ticker})})]}),(0,l.jsx)(O.j,{children:(0,l.jsx)(t.A,{onClick:()=>{e.push("/account")},color:"primary",children:"上架"})})]}),(0,l.jsx)("div",{children:(0,l.jsx)("div",{className:"flex gap-2 flex-wrap",children:g.map(e=>(0,l.jsx)(n.w,{isHoverable:!0,className:"px-2",children:(0,l.jsxs)(i.G,{className:"text-center",children:[(0,l.jsx)("div",{className:"text-base h-6 md:h-8 md:text-2xl font-bold ",children:e.value}),(0,l.jsx)("div",{className:"text-xs md:text-sm",children:e.label})]})},e.label))})})]}),(0,l.jsx)(c.j,{}),(0,l.jsx)("div",{className:"pt-4",children:(0,l.jsxs)(u.n,{"aria-label":"Options",children:[(0,l.jsx)(m.r,{title:"市场",children:(0,l.jsx)($,{ticker:x})},"market"),(0,l.jsx)(m.r,{title:"交易历史",children:(0,l.jsx)(H.K,{ticker:x})},"history"),(0,l.jsx)(m.r,{title:"我的挂单",children:(0,l.jsx)(O.j,{className:"mx-auto mt-20 block",children:(0,l.jsx)($,{ticker:x,address:a})})},"my")]})})]})}},89324:function(e,s,a){"use strict";a.d(s,{j:function(){return n}});var l=a(57437),r=a(25677),t=a(89860);a(2265);let n=e=>{let{children:s,className:a}=e,{connected:n,setModalVisible:i}=(0,t.$)(e=>e);return n?(0,l.jsx)(l.Fragment,{children:s}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r.A,{onClick:()=>i(!0),size:"sm",radius:"full",className:a,color:"primary",children:"Connect Wallet"})})}}},function(e){e.O(0,[121,645,551,677,920,257,328,26,853,750,736,726,60,971,472,744],function(){return e(e.s=3833)}),_N_E=e.O()}]);