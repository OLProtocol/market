(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2318],{35783:function(e,s,t){Promise.resolve().then(t.bind(t,31535))},31535:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return D}});var a=t(57437),r=t(1377),l=t(42228),i=t(2131),n=t(19409),o=t(21250),d=t(47752),c=t(10134),u=t(94294),m=t(38793),b=t(64087),x=t(39712),f=t(4922),h=t(99008),p=t(65349),v=t(86418),g=t(62234),j=t(77807),y=t(2265),w=t(2889),N=t(7719),_=t(19242),P=t(47448),k=t(98286),C=t(43949),B=t(99376),S=t(85323),R=t(95011);function D(){let{t:e}=(0,C.$G)(),s=(0,B.useRouter)(),[t,D]=(0,y.useState)(!1),{assets_name:z,assets_type:F,list:H,reset:T,unit:U,amountUnit:W,changeAmountUnit:Z,changeUnit:A,changePrice:G}=(0,j.JU)(e=>e),[I,O]=(0,y.useState)(!1),[E,M]=(0,y.useState)();console.log("app.account.sell.page: list: ",H);let{network:X,address:K,btcWallet:L}=(0,P.$)(e=>e),{data:V,isLoading:J}=(0,S.ZP)("getAssetsSummary-".concat(z,"-").concat(F,"-").concat(X),()=>{console.log("app.account.sell.page: ticker: ",z);try{return(0,k.zU)({assets_name:z,assets_type:F})}catch(e){console.log("app.account.sell.page: getAssetsSummary err: ",e)}},{revalidateOnFocus:!1,revalidateOnReconnect:!1}),Y=(0,y.useMemo)(()=>{var e;return(null==V?void 0:null===(e=V.data)||void 0===e?void 0:e.summary)||{}},[V]);(0,y.useEffect)(()=>{if(Y.lowest_price)for(let e of H)"btc"===U?G(e.utxo,(0,w.Ay)(parseInt(Y.lowest_price)).toString()):G(e.utxo,parseInt(Y.lowest_price).toString())},[Y]),(0,R.Z)(()=>{if(I){let e=E?Number(E):0;for(let s=0;s<H.length;s++)G(H[s].utxo,e.toString())}},300,[I,E]);let $=async()=>{for(let s=0;s<H.length;s++){let{price:t,assets_list:a}=H[s];if(330>Number("btc"===W?(0,w.g)(t):t)){g.ZP.error({message:e("notification.list_failed_title"),description:e("notification.list_failed_min_amount")});return}}if(!(0,N.Sd)(K,X)){g.ZP.error({message:e("notification.list_failed_title"),description:e("notification.list_failed_p2tr_required")});return}D(!0);try{let t=await (0,w.c8)({inscriptionUtxos:H,address:K,network:X,unit:W});console.log("Batch Order PSBT",t);let a=await (null==L?void 0:L.signPsbt(t));if(console.log("Batch Order raw",a),a){let t=(0,w.T1)(a,X),r=H.map((e,s)=>{let a;let{assets_list:r}=e;return{assets_name:(a="ticker"===F?r.find(e=>e.assets_name===z):r.find(e=>e.assets_type===F)).assets_name,assets_type:a.assets_type,raw:t[s]}}),l=await (0,k.wC)({address:K,orders:r});200===l.code?(g.ZP.success({message:e("notification.list_success_title"),description:e("notification.list_success_description")}),T(),s.back()):g.ZP.error({message:e("notification.list_failed_title"),description:l.msg})}D(!1)}catch(s){D(!1),console.error("List failed",s),g.ZP.error({message:e("notification.list_failed_title"),description:s.message})}},q=e=>{},Q=e=>{e!==U&&e&&A(e)},ee=e=>{console.log("unit change",e),e!==W&&e&&Z(e)},es=(0,y.useMemo)(()=>H.reduce((e,s)=>{let t=new _.t(e),a=new _.t(Number(s.price));return t.plus(a).toNumber()},0)||0,[H]);return(0,a.jsx)("div",{className:"py-2",children:(0,a.jsxs)("div",{className:"md:flex justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 mb-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-2 md:flex-row md:items-center  ",children:[J?(0,a.jsx)(r.c,{}):(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{children:[e("common.lowest_price"),":"]}),(0,a.jsxs)("span",{children:[Y.lowest_price," Sats"]})]})]}),(0,a.jsxs)("div",{className:"w-full flex items-center gap-1 sm:w-80",children:[(0,a.jsx)(l.Y,{type:"number",placeholder:"Custome Global Unit Price",value:E,onValueChange:e=>{O(!0),M(e)}}),(0,a.jsxs)(i.g,{size:"sm",color:"primary",isDisabled:J,selectedKeys:[U],onChange:e=>Q(e.target.value),className:"w-28",children:[(0,a.jsx)(n.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(n.R,{value:"sats",children:"sats"},"sats")]})]})]}),(0,a.jsxs)(o.b,{"aria-label":"Example static collection table",children:[(0,a.jsxs)(d.J,{children:[(0,a.jsx)(c.j,{className:"text-sm md:text-base",children:e("common.item")}),(0,a.jsx)(c.j,{className:"text-sm md:text-base ",children:(0,a.jsxs)("div",{className:"flex  items-center gap-2",children:[e("common.sell_unit_price"),(0,a.jsxs)(i.g,{size:"sm",color:"primary",isDisabled:J,selectedKeys:[U],onChange:e=>Q(e.target.value),className:"w-28",children:[(0,a.jsx)(n.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(n.R,{value:"sats",children:"sats"},"sats")]})]})}),(0,a.jsx)(c.j,{className:"text-sm md:text-base",children:(0,a.jsxs)("div",{className:"flex  items-center gap-2",children:[e("common.amount"),(0,a.jsxs)(i.g,{size:"sm",color:"primary",isDisabled:J,selectedKeys:[W],onChange:e=>ee(e.target.value),className:"w-28",children:[(0,a.jsx)(n.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(n.R,{value:"sats",children:"sats"},"sats")]})]})})]}),(0,a.jsx)(u.y,{children:H.map((s,t)=>{var r;return(0,a.jsxs)(m.g,{children:[(0,a.jsxs)(b.X,{children:[(0,a.jsx)("div",{className:"mb-2 flex flex-wrap items-center gap-4",children:null===(r=s.assets_list)||void 0===r?void 0:r.map(s=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:["ns"===s.assets_type?"Name":"Ticker","："]}),(0,a.jsx)("span",{children:s.assets_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[e("common.asset_num"),"："]}),(0,a.jsx)("span",{children:s.amount})]})]},s.assets_name))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400 mr-4",children:"Sats:"}),s.value]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Utxo："}),(0,a.jsx)(x.Z,{codeString:null==s?void 0:s.utxo,className:"bg-transparent text-gray-500",symbol:"",size:"lg",variant:"flat",children:(0,a.jsx)("span",{className:"font-thin",children:(0,w.NH)(null==s?void 0:s.utxo,6)})})]})]}),(0,a.jsx)(b.X,{children:(0,a.jsx)(l.Y,{type:"number",placeholder:"0.00",isDisabled:J,value:H[t].unit_price,onValueChange:e=>{O(!1),M(void 0),G(s.utxo,e)},onBlur:()=>q(s.utxo)})}),(0,a.jsx)(b.X,{className:"text-center",children:s.price})]},s.utxo)})})]})]}),(0,a.jsxs)(f.w,{className:"sm:w-60 ",children:[(0,a.jsxs)(h.G,{children:[(0,a.jsxs)("div",{children:[e("common.total"),": ",H.length]}),(0,a.jsxs)("div",{children:[e("common.your_profits"),": ",es," ","btc"===W?"BTC":"Sats"]})]}),(0,a.jsx)(p.i,{children:(0,a.jsx)(v.A,{isDisabled:es<=0,color:"primary",isLoading:t,className:"w-full",onClick:$,children:e("buttons.list_sale")})})]})]})})}},99376:function(e,s,t){"use strict";var a=t(35475);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},99008:function(e,s,t){"use strict";t.d(s,{G:function(){return d}});var a=t(53921),r=t(72243),l=t(88160),i=t(46763),n=t(57437),o=(0,r.Gp)((e,s)=>{var t;let{as:r,className:o,children:d,...c}=e,u=(0,l.gy)(s),{slots:m,classNames:b}=(0,a.R)(),x=(0,i.W)(null==b?void 0:b.body,o);return(0,n.jsx)(r||"div",{ref:u,className:null==(t=m.body)?void 0:t.call(m,{class:x}),...c,children:d})});o.displayName="NextUI.CardBody";var d=o},4922:function(e,s,t){"use strict";t.d(s,{w:function(){return _}});var a=t(53921),r=t(26543),l=t(18373),i=(0,r.tv)({slots:{base:["flex","flex-col","relative","overflow-hidden","h-auto","outline-none","text-foreground","box-border","bg-content1",...l.Dh],header:["flex","p-3","z-10","w-full","justify-start","items-center","shrink-0","overflow-inherit","color-inherit","subpixel-antialiased"],body:["relative","flex","flex-1","w-full","p-3","flex-auto","flex-col","place-content-inherit","align-items-inherit","h-auto","break-words","text-left","overflow-y-auto","subpixel-antialiased"],footer:["p-3","h-auto","flex","w-full","items-center","overflow-hidden","color-inherit","subpixel-antialiased"]},variants:{shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},radius:{none:{base:"rounded-none",header:"rounded-none",footer:"rounded-none"},sm:{base:"rounded-small",header:"rounded-t-small",footer:"rounded-b-small"},md:{base:"rounded-medium",header:"rounded-t-medium",footer:"rounded-b-medium"},lg:{base:"rounded-large",header:"rounded-t-large",footer:"rounded-b-large"}},fullWidth:{true:{base:"w-full"}},isHoverable:{true:{base:"data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2"}},isPressable:{true:{base:"cursor-pointer"}},isBlurred:{true:{base:["bg-background/80","dark:bg-background/20","backdrop-blur-md","backdrop-saturate-150"]}},isFooterBlurred:{true:{footer:["bg-background/10","backdrop-blur","backdrop-saturate-150"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:"",false:{base:"transition-transform-background motion-reduce:transition-none"}}},compoundVariants:[{isPressable:!0,class:"data-[pressed=true]:scale-[0.97] tap-highlight-transparent"}],defaultVariants:{radius:"lg",shadow:"md",fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),n=t(2265),o=t(62319),d=t(5376),c=t(56037),u=t(11323),m=t(6422),b=t(2646),x=t(72243),f=t(46763),h=t(68658),p=t(97765),v=t(27246),g=t(88160),j=t(62577),y=t(78974),w=t(57437),N=(0,x.Gp)((e,s)=>{let{children:t,context:r,Component:l,isPressable:N,disableAnimation:_,disableRipple:P,getCardProps:k,getRippleProps:C}=function(e){var s,t,a,r;let l=(0,b.w)(),[y,w]=(0,x.oe)(e,i.variantKeys),{ref:N,as:_,children:P,onClick:k,onPress:C,autoFocus:B,className:S,classNames:R,allowTextSelectionOnPress:D=!0,...z}=y,F=(0,g.gy)(N),H=_||(e.isPressable?"button":"div"),T="string"==typeof H,U=null!=(t=null!=(s=e.disableAnimation)?s:null==l?void 0:l.disableAnimation)&&t,W=null!=(r=null!=(a=e.disableRipple)?a:null==l?void 0:l.disableRipple)&&r,Z=(0,f.W)(null==R?void 0:R.base,S),{onClick:A,onClear:G,ripples:I}=(0,j.i)(),O=e=>{U||W||!F.current||A(e)},{buttonProps:E,isPressed:M}=(0,m.j)({onPress:C,elementType:_,isDisabled:!e.isPressable,onClick:(0,o.t)(k,O),allowTextSelectionOnPress:D,...z},F),{hoverProps:X,isHovered:K}=(0,u.X)({isDisabled:!e.isHoverable,...z}),{isFocusVisible:L,isFocused:V,focusProps:J}=(0,c.F)({autoFocus:B}),Y=(0,n.useMemo)(()=>i({...w,disableAnimation:U}),[(0,h.Xx)(w),U]),$=(0,n.useMemo)(()=>({slots:Y,classNames:R,disableAnimation:U,isDisabled:e.isDisabled,isFooterBlurred:e.isFooterBlurred,fullWidth:e.fullWidth}),[Y,R,e.isDisabled,e.isFooterBlurred,U,e.fullWidth]),q=(0,n.useCallback)(function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ref:F,className:Y.base({class:Z}),tabIndex:e.isPressable?0:-1,"data-hover":(0,p.PB)(K),"data-pressed":(0,p.PB)(M),"data-focus":(0,p.PB)(V),"data-focus-visible":(0,p.PB)(L),"data-disabled":(0,p.PB)(e.isDisabled),...(0,d.d)(e.isPressable?{...E,...J,role:"button"}:{},e.isHoverable?X:{},(0,v.z)(z,{enabled:T}),(0,v.z)(s))}},[F,Y,Z,T,e.isPressable,e.isHoverable,e.isDisabled,K,M,L,E,J,X,z]),Q=(0,n.useCallback)(()=>({ripples:I,onClear:G}),[I,G]);return{context:$,domRef:F,Component:H,classNames:R,children:P,isHovered:K,isPressed:M,disableAnimation:U,isPressable:e.isPressable,isHoverable:e.isHoverable,disableRipple:W,handleClick:O,isFocusVisible:L,getCardProps:q,getRippleProps:Q}}({...e,ref:s});return(0,w.jsxs)(l,{...k(),children:[(0,w.jsx)(a.k,{value:r,children:t}),N&&!_&&!P&&(0,w.jsx)(y.L,{...C()})]})});N.displayName="NextUI.Card";var _=N},65349:function(e,s,t){"use strict";t.d(s,{i:function(){return d}});var a=t(53921),r=t(72243),l=t(88160),i=t(46763),n=t(57437),o=(0,r.Gp)((e,s)=>{var t;let{as:r,className:o,children:d,...c}=e,u=(0,l.gy)(s),{slots:m,classNames:b}=(0,a.R)(),x=(0,i.W)(null==b?void 0:b.footer,o);return(0,n.jsx)(r||"div",{ref:u,className:null==(t=m.footer)?void 0:t.call(m,{class:x}),...c,children:d})});o.displayName="NextUI.CardFooter";var d=o},53921:function(e,s,t){"use strict";t.d(s,{R:function(){return r},k:function(){return a}});var[a,r]=(0,t(40280).k)({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"})}},function(e){e.O(0,[3121,1866,1645,8218,8991,9874,2234,1349,9222,992,1800,4214,1512,3541,694,1865,738,7233,2971,2117,1744],function(){return e(e.s=35783)}),_N_E=e.O()}]);