(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2318],{62300:function(e,s,t){Promise.resolve().then(t.bind(t,31535))},31535:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Z}});var a=t(57437),i=t(84555),l=t(27985),n=t(5283),r=t(19409),c=t(54163),o=t(47752),d=t(10134),m=t(94294),u=t(38793),x=t(64087),h=t(13264),p=t(93649),f=t(99008),g=t(65349),j=t(50820),v=t(62234),_=t(77807),b=t(2265),N=t(2889),y=t(7719),w=t(19242),S=t(47448),P=t(98286),C=t(43949),R=t(99376),k=t(85323),B=t(95011);function Z(){let{t:e}=(0,C.$G)(),s=(0,R.useRouter)(),[t,Z]=(0,b.useState)(!1),{assets_name:T,assets_type:O,list:U,reset:z,unit:D,amountUnit:E,changeAmountUnit:A,changeUnit:G,changePrice:I}=(0,_.JU)(e=>e),[K,L]=(0,b.useState)(!1),[X,F]=(0,b.useState)();console.log("app.account.sell.page: list: ",U);let{network:J,address:M,btcWallet:V}=(0,S.$)(e=>e),{data:Y,isLoading:$}=(0,k.ZP)("getAssetsSummary-".concat(T,"-").concat(O,"-").concat(J),()=>{console.log("app.account.sell.page: ticker: ",T);try{return(0,P.zU)({assets_name:T,assets_type:O})}catch(e){console.log("app.account.sell.page: getAssetsSummary err: ",e)}},{revalidateOnFocus:!1,revalidateOnReconnect:!1}),q=(0,b.useMemo)(()=>{var e;return(null==Y?void 0:null===(e=Y.data)||void 0===e?void 0:e.summary)||{}},[Y]);(0,b.useEffect)(()=>{if(q.lowest_price)for(let e of U)"btc"===D?I(e.utxo,(0,N.Ay)(parseInt(q.lowest_price)).toString()):I(e.utxo,parseInt(q.lowest_price).toString())},[q]),(0,B.Z)(()=>{if(K){let e=X?Number(X):0;for(let s=0;s<U.length;s++)I(U[s].utxo,e.toString())}},300,[K,X]);let H=async()=>{for(let s=0;s<U.length;s++){let{price:t,assets_list:a}=U[s];if(330>Number("btc"===E?(0,N.g)(t):t)){v.ZP.error({message:e("notification.list_failed_title"),description:e("notification.list_failed_min_amount")});return}}if(!(0,y.Sd)(M,J)){v.ZP.error({message:e("notification.list_failed_title"),description:e("notification.list_failed_p2tr_required")});return}Z(!0);try{let t=await (0,N.c8)({inscriptionUtxos:U,address:M,network:J,unit:E});console.log("Batch Order PSBT",t);let a=await (null==V?void 0:V.signPsbt(t));if(console.log("Batch Order raw",a),a){let t=(0,N.T1)(a,J),i=U.map((e,s)=>{let a;let{assets_list:i}=e;return{assets_name:(a="ticker"===O?i.find(e=>e.assets_name===T):i.find(e=>e.assets_type===O)).assets_name,assets_type:a.assets_type,raw:t[s]}}),l=await (0,P.wC)({address:M,orders:i});200===l.code?(v.ZP.success({message:e("notification.list_success_title"),description:e("notification.list_success_description")}),z(),s.back()):v.ZP.error({message:e("notification.list_failed_title"),description:l.msg})}Z(!1)}catch(s){Z(!1),console.error("List failed",s),v.ZP.error({message:e("notification.list_failed_title"),description:s.message})}},W=e=>{},Q=e=>{e!==D&&e&&G(e)},ee=e=>{console.log("unit change",e),e!==E&&e&&A(e)},es=(0,b.useMemo)(()=>U.reduce((e,s)=>{let t=new w.t(e),a=new w.t(Number(s.price));return t.plus(a).toNumber()},0)||0,[U]);return(0,a.jsx)("div",{className:"py-2",children:(0,a.jsxs)("div",{className:"md:flex justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 mb-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-2 md:flex-row md:items-center  ",children:[$?(0,a.jsx)(i.c,{}):(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{children:[e("common.lowest_price"),":"]}),(0,a.jsxs)("span",{children:[q.lowest_price," Sats"]})]})]}),(0,a.jsxs)("div",{className:"w-full flex items-center gap-1 sm:w-80",children:[(0,a.jsx)(l.Y,{type:"number",placeholder:"Custome Global Unit Price",value:X,onValueChange:e=>{L(!0),F(e)}}),(0,a.jsxs)(n.g,{size:"sm",color:"primary",isDisabled:$,selectedKeys:[D],onChange:e=>Q(e.target.value),className:"w-28",children:[(0,a.jsx)(r.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(r.R,{value:"sats",children:"sats"},"sats")]})]})]}),(0,a.jsxs)(c.b,{"aria-label":"Example static collection table",children:[(0,a.jsxs)(o.J,{children:[(0,a.jsx)(d.j,{className:"text-sm md:text-base",children:e("common.item")}),(0,a.jsx)(d.j,{className:"text-sm md:text-base ",children:(0,a.jsxs)("div",{className:"flex  items-center gap-2",children:[e("common.sell_unit_price"),(0,a.jsxs)(n.g,{size:"sm",color:"primary",isDisabled:$,selectedKeys:[D],onChange:e=>Q(e.target.value),className:"w-28",children:[(0,a.jsx)(r.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(r.R,{value:"sats",children:"sats"},"sats")]})]})}),(0,a.jsx)(d.j,{className:"text-sm md:text-base",children:(0,a.jsxs)("div",{className:"flex  items-center gap-2",children:[e("common.amount"),(0,a.jsxs)(n.g,{size:"sm",color:"primary",isDisabled:$,selectedKeys:[E],onChange:e=>ee(e.target.value),className:"w-28",children:[(0,a.jsx)(r.R,{value:"btc",children:"BTC"},"btc"),(0,a.jsx)(r.R,{value:"sats",children:"sats"},"sats")]})]})})]}),(0,a.jsx)(m.y,{children:U.map((s,t)=>{var i;return(0,a.jsxs)(u.g,{children:[(0,a.jsxs)(x.X,{children:[(0,a.jsx)("div",{className:"mb-2 flex flex-wrap items-center gap-4",children:null===(i=s.assets_list)||void 0===i?void 0:i.map(s=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:["ns"===s.assets_type?"Name":"Ticker","："]}),(0,a.jsx)("span",{children:s.assets_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[e("common.asset_num"),"："]}),(0,a.jsx)("span",{children:s.amount})]})]},s.assets_name))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-400 mr-4",children:"Sats:"}),s.value]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Utxo："}),(0,a.jsx)(h.Z,{codeString:null==s?void 0:s.utxo,className:"bg-transparent text-gray-500",symbol:"",size:"lg",variant:"flat",children:(0,a.jsx)("span",{className:"font-thin",children:(0,N.NH)(null==s?void 0:s.utxo,6)})})]})]}),(0,a.jsx)(x.X,{children:(0,a.jsx)(l.Y,{type:"number",placeholder:"0.00",isDisabled:$,value:U[t].unit_price,onValueChange:e=>{L(!1),F(void 0),I(s.utxo,e)},onBlur:()=>W(s.utxo)})}),(0,a.jsx)(x.X,{className:"text-center",children:s.price})]},s.utxo)})})]})]}),(0,a.jsxs)(p.w,{className:"sm:w-60 ",children:[(0,a.jsxs)(f.G,{children:[(0,a.jsxs)("div",{children:[e("common.total"),": ",U.length]}),(0,a.jsxs)("div",{children:[e("common.your_profits"),": ",es," ","btc"===E?"BTC":"Sats"]})]}),(0,a.jsx)(g.i,{children:(0,a.jsx)(j.A,{isDisabled:es<=0,color:"primary",isLoading:t,className:"w-full",onClick:H,children:e("buttons.list_sale")})})]})]})})}},99376:function(e,s,t){"use strict";var a=t(35475);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},65349:function(e,s,t){"use strict";t.d(s,{i:function(){return o}});var a=t(53921),i=t(72243),l=t(88160),n=t(46763),r=t(57437),c=(0,i.Gp)((e,s)=>{var t;let{as:i,className:c,children:o,...d}=e,m=(0,l.gy)(s),{slots:u,classNames:x}=(0,a.R)(),h=(0,n.W)(null==x?void 0:x.footer,c);return(0,r.jsx)(i||"div",{ref:m,className:null==(t=u.footer)?void 0:t.call(u,{class:h}),...d,children:o})});c.displayName="NextUI.CardFooter";var o=c}},function(e){e.O(0,[3121,1866,1645,8218,712,9874,2234,9663,7211,7024,2116,2229,8363,2396,5392,871,7233,2971,2117,1744],function(){return e(e.s=62300)}),_N_E=e.O()}]);