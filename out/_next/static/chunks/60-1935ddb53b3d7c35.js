"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{62478:function(t,e,n){n.d(e,{Hj:function(){return v},sl:function(){return x},jn:function(){return g},Sf:function(){return y},s1:function(){return c},AU:function(){return u},Ro:function(){return i},RK:function(){return o},eb:function(){return d},Oy:function(){return j},wt:function(){return m},xS:function(){return f},pm:function(){return p},n3:function(){return h}});var a=n(56690),r=n(87714),s=n(89860);let l=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{publicKey:n,connected:l}=s.$.getState(),{signature:i}=r.E.getState(),{headers:o={},method:u="GET",data:c}=e,d="https://apitest.ordx.market".concat(t);if("GET"===u){let t=new URLSearchParams((0,a.$B)(c));d+="?".concat(t)}else"POST"===u&&(e.body=JSON.stringify(c),o["Content-Type"]="application/json");l&&i&&(o.Publickey=n,o.Signature=i),delete e.data,e.headers=o;let p=await fetch(d,e);return p},i=async t=>{let{address:e,offset:n,size:a,type:r,ticker:s}=t,i=await l("/ordx/GetAddressOrdxAssets",{data:{address:e,offset:n,size:a,type:r,ticker:s}});return i.json()},o=async t=>{let{ticker:e}=t,n=await l("/ordx/GetTickerSummary",{data:{ticker:e}});return n.json()},u=async t=>{let{ticker:e,offset:n,size:a,sort:r=0,type:s=1,address:i}=t,o=await l("/ordx/GetOrders",{data:{ticker:e,offset:n,size:a,sort:r,type:s,address:i}});return o.json()},c=async t=>{let{ticker:e,offset:n,size:a,sort:r=0,address:s}=t,i=await l("/ordx/GetHistory",{data:{ticker:e,offset:n,size:a,sort:r,address:s}});return i.json()},d=async t=>{let{interval:e=1,top_count:n=10,top_list:a="tx_amount"}=t,r=await l("/ordx/GetTopTickers",{data:{interval:e,top_count:n,top_list:a}});return r.json()},p=async t=>{let{address:e,raw:n}=t,a=await l("/ordx/SubmitOrder",{method:"POST",data:{address:e,raw:n}});return a.json()},x=async t=>{let{address:e,order_id:n}=t,a=await l("/ordx/CancelOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},f=async t=>{let{address:e,order_id:n}=t,a=await l("/ordx/LockOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},h=async t=>{let{address:e,order_id:n}=t,a=await l("/ordx/UnlockOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},v=async t=>{let{address:e,order_id:n,raw:a}=t,r=await l("/ordx/BuyOrder",{method:"POST",data:{address:e,order_id:n,raw:a}});return r.json()},m=async t=>{let{address:e,value:n=600,network:a}=t,r=await fetch("https://apitest.ordx.space/testnet/utxo/getUtxoByValue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e,value:n})});return r.json()},g=async t=>{let e=await fetch("testnet"===t?"https://mempool.space/testnet/api/v1/fees/recommended":"https://mempool.space/api/v1/fees/recommended"),n=await e.json();return n},y=async()=>{let t=await fetch("/version.txt");return console.log("appVersion",await t.text()),t.text()},j=async(t,e)=>{let n="https://mempool.space".concat("testnet"===e?"/testnet":"","/api/tx/").concat(t,"/hex"),a=await fetch(n).then(t=>t.text()).then(t=>{if("Transaction not found"===t)throw Error("Some error happened when finding BTC to pay. Please try again later.");return t});return a}},28034:function(t,e,n){n.d(e,{V:function(){return s}});var a=n(57437),r=n(78507);n(2265);let s=t=>{let{loading:e=!0,className:n,children:s}=t;return(0,a.jsxs)("div",{className:"relative ".concat(n),children:[s,e&&(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 z-10 -translate-x-1/2 -translate-y-1/2",children:(0,a.jsx)(r.c,{})})]})}},31197:function(t,e,n){n.d(e,{t:function(){return s}});var a=n(57437);n(2265);var r=n(59769);let s=t=>{let{total:e,page:n,size:s,onChange:l}=t;return(0,a.jsx)(r.g,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",total:e,initialPage:1,page:n,onChange:l})}},41298:function(t,e,n){n.d(e,{K:function(){return S}});var a=n(57437),r=n(42853),s=n(84082),l=n(64903),i=n(53115),o=n(2014),u=n(78507),c=n(51240),d=n(52037),p=n(1525),x=n(27679),f=n(62478),h=n(2265),v=n(56690),m=n(39830),g=n(89860),y=n(31197),j=n(85588),w=n(19174);let b=t=>{let{value:e,onChange:n,disabled:r=!1}=t,[s,l]=(0,h.useState)([(null==e?void 0:e.toString())||"0"]);return(0,a.jsx)(j.g,{isDisabled:r,className:"w-40",selectionMode:"single",selectedKeys:s,defaultSelectedKeys:["0"],onSelectionChange:t=>{l(t);let e=Number(Array.from(t.values())[0]);null==n||n(e)},children:[{label:"不排序",value:0},{label:"价格升序",value:1},{label:"价格降序",value:2},{label:"时间升序",value:3},{label:"时间降序",value:4}].map(t=>(0,a.jsx)(w.R,{value:t.value,children:t.label},t.value))})},S=t=>{let{ticker:e,address:n}=t,{network:j}=(0,g.$)(t=>t),[w,S]=(0,h.useState)(1),[O,k]=(0,h.useState)(10),[T,N]=(0,h.useState)(0),{data:U,isLoading:C}=(0,r.ZP)("/ordx/history-".concat(e,"-").concat(n,"-").concat(w,"-").concat(O,"-").concat(T),()=>(0,f.s1)({offset:(w-1)*O,size:O,ticker:e,address:n,sort:T}),{revalidateOnMount:!0}),P=(0,h.useMemo)(()=>{var t,e;return(null==U?void 0:null===(t=U.data)||void 0===t?void 0:t.total)?Math.ceil((null==U?void 0:null===(e=U.data)||void 0===e?void 0:e.total)/O):0},[U,O]),E=(0,h.useMemo)(()=>({1:"成交",2:"下架",3:"无效",10:"卖出",11:"买入"}),[]),H=(0,h.useMemo)(()=>{let t=[{key:"utxo",label:"Utxo",align:"center"},{key:"price",label:"Price",align:"center"},{key:"value",label:"Num",align:"center"},{key:"address",label:"From",align:"center"},{key:"txaddress",label:"To",align:"center",hideHeader:!0},{key:"txtime",label:"Time",align:"center"},{key:"txid",label:"Tx",allowsSorting:!1,align:"center"}],e=t.findIndex(t=>"txaddress"===t.key);return n&&(t.splice(e,1),t.unshift({key:"result",label:"Type",align:"center"})),t},[n]),W=(0,h.useMemo)(()=>{var t;return(null==U?void 0:null===(t=U.data)||void 0===t?void 0:t.order_list)||[]},[U]);return(0,a.jsx)("div",{className:"",children:(0,a.jsxs)(s.b,{isHeaderSticky:!0,isStriped:!0,topContent:(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(b,{disabled:!W.length,onChange:t=>{void 0!==t&&N(t)}})}),bottomContent:w>1?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(y.t,{total:P,offset:w,size:O,onChange:(t,e)=>{S(t)}})}):null,children:[(0,a.jsx)(l.J,{columns:H,children:H.map(t=>(0,a.jsx)(i.j,{align:t.align,children:t.label},t.key))}),(0,a.jsx)(o.y,{isLoading:C,items:W,emptyContent:"No Data.",loadingContent:(0,a.jsx)(u.c,{}),children:t=>(0,a.jsx)(c.g,{children:e=>{if("utxo"===e||"txaddress"===e||"address"===e){let n=(0,d.sF)(t,e);return(0,a.jsx)(p.X,{children:n?(0,a.jsx)(x.Z,{codeString:n,className:"bg-transparent",symbol:"",size:"lg",variant:"flat",children:(0,v.NH)(n,6)}):"-"})}return"txid"===e?(0,a.jsx)(p.X,{children:(0,a.jsx)("a",{href:(0,v.a)((0,d.sF)(t,e),j),target:"_blank",children:(0,a.jsx)(m.JO,{icon:"ph:share-fill"})})}):"txtime"===e?(0,a.jsx)(p.X,{children:(0,a.jsx)("span",{children:new Date(Number((0,d.sF)(t,e))).toLocaleString()})}):"result"===e?(0,a.jsx)(p.X,{children:E[(0,d.sF)(t,e)]}):(0,a.jsx)(p.X,{children:"".concat((0,d.sF)(t,e)).concat("price"===e?" "+t.currency:"")})}},t.order_id)})]})})}},56690:function(t,e,n){n.d(e,{g:function(){return j},Us:function(){return d},eB:function(){return c},zU:function(){return w},NH:function(){return b},u4:function(){return g},$B:function(){return S},a:function(){return O},Ay:function(){return y}});var a=n(99301),r=n(81254),s=n(24128),l=n(89860),i=n(62478),o=n(40263).Buffer;let u=t=>{var e;let n=null===(e=s.Xf.fmt.toAsm(s.kL.toScriptPubKey(t)))||void 0===e?void 0:e[0];return n},c=async t=>{let{inscriptionUtxo:e,total:n,network:s,address:o}=t,{btcWallet:u}=l.$.getState(),c=await (0,i.Oy)(e.txid,s),d=a.YW.fromHex(c),p={hash:e.txid,index:e.vout,witnessUtxo:d.outs[e.vout],sighashType:131},x=new a._B({network:"testnet"===s?a.QW.testnet:a.QW.bitcoin});if(a.Wi(r),x.addInput(p),x.addOutput({address:o,value:n}),!u)throw Error("Wallet not initialized");let f=await u.signPsbt(x.toHex());return f},d=async t=>{let{orderRaw:e,network:n,address:s,fee:i,utxos:c,serviceFee:d,dummyUtxos:p}=t,x="tb1pttjr9292tea2nr28ca9zswgdhz0dasnz6n3v58mtg9cyf9wqr49sv8zjep",{btcWallet:f}=l.$.getState();a.Wi(r);let h="testnet"===n?a.QW.testnet:a.QW.bitcoin,v=a._B.fromHex(e,{network:h}),m=new a._B({network:h});console.log(v);let g=c.reduce((t,e)=>t+e.value,0),y=c.map(t=>({hash:t.txid,index:t.vout,witnessUtxo:{script:o.from(u(s),"hex"),value:t.value}})),j=p.reduce((t,e)=>t+e.value,0),w=p.map(t=>({hash:t.txid,index:t.vout,witnessUtxo:{script:o.from(u(s),"hex"),value:t.value},sighashType:a.YW.SIGHASH_ALL}));w.forEach(t=>{m.addInput(t)}),m.addOutput({address:s,value:j}),console.log(y);let b={hash:v.txInputs[0].hash,index:v.txInputs[0].index,witnessUtxo:v.data.inputs[0].witnessUtxo,finalScriptWitness:v.data.inputs[0].finalScriptWitness};m.addInput(b),y.forEach(t=>{m.addInput(t)});let S=v.data.inputs[0].witnessUtxo.value;m.addOutput({address:s,value:S});let O=v.txOutputs[0].value,k=v.txOutputs[0];m.addOutput(k);let T=g-(O+i)-1200;d&&x&&(T-=d,m.addOutput({address:x,value:d})),m.addOutput({address:s,value:600}),m.addOutput({address:s,value:600});let N={address:s,value:T};if(m.addOutput(N),!f)throw Error("Wallet not initialized");let U=await f.signPsbt(m.toHex()),C=a._B.fromHex(U,{network:h}),P=C.extractTransaction(),E=P.toHex();return E};var p=n(51864),x=n.n(p),f=n(90555),h=n.n(f),v=n(34098),m=n.n(v);let g=t=>{let[e,n]=t.split(":");return{txid:e,vout:parseInt(n)}},y=t=>{t>=1e8&&(t*=10);let e=String(t).padStart(8,"0").slice(0,-9)+"."+String(t).padStart(8,"0").slice(-9);return"."==e.substring(0,1)&&(e="0"+e),e},j=t=>{let[e,n]=t.toString().split(".");return n||(n="0"),1e8*parseInt(e)+parseInt(n.padEnd(8,"0"))},w=function(t,e){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=x()(t,"value"),r=m()(a);n&&h()(r);let s=[],l=0;for(let t=0;t<r.length;t++){let n=r[t];if(s.push(n),(l+=n.value)>=e)break}let i=a.slice(0,2),o=[];for(let t=0;t<i.length;t++)s.some(e=>e.txid===i[t].txid)||o.push(i[t]);return{minUtxo:a[0],maxUtxo:a[a.length-1],utxos:s,smallTwoUtxos:o,total:l}},b=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*****";return"string"==typeof t&&t?"".concat(null==t?void 0:t.substring(0,e)).concat(n).concat(null==t?void 0:t.substring((null==t?void 0:t.length)-e)):""},S=t=>{let e={...t};return Object.keys(e).forEach(t=>{(""===e[t]||void 0===e[t]||null===e[t]||"null"===e[t]||"undefined"===e[t]||"NaN"===e[t]||isNaN(e[t])&&"number"==typeof e[t])&&delete e[t]}),e},O=(t,e)=>"testnet"===e?"https://mempool.space/testnet/tx/".concat(t):"https://mempool.space/tx/".concat(t)},87714:function(t,e,n){n.d(e,{E:function(){return l},J:function(){return s}});var a=n(94660),r=n(74810);let s=(0,a.Ue)()((0,r.mW)(t=>({list:[],add:e=>{t(t=>({list:[...t.list,e]}))},reset:()=>{t({list:[]})}}))),l=(0,a.Ue)()((0,r.mW)((0,r.tJ)(t=>({feeRate:{value:1,type:"custom"},appVersion:0,signature:"",setSignature:e=>{t({signature:e})},setFeeRate:e=>{t({feeRate:e})},reset:()=>{t({feeRate:{value:1,type:"custom"},appVersion:0})}}),{name:"common-store",partialize:t=>Object.fromEntries(Object.entries(t).filter(t=>{let[e]=t;return["signature"].includes(e)}))})))}}]);