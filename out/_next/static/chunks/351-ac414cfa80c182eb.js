"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[351],{62478:function(t,e,n){n.d(e,{Hj:function(){return f},sl:function(){return d},jn:function(){return x},s1:function(){return u},AU:function(){return s},Ro:function(){return o},RK:function(){return i},eb:function(){return l},Oy:function(){return m},wt:function(){return h},xS:function(){return p},pm:function(){return c},n3:function(){return w}});var a=n(56690);let r=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{headers:n={},method:r="GET",data:o}=e,i="http://192.168.1.2:9999".concat(t);if("GET"===r){let t=new URLSearchParams((0,a.$B)(o));i+="?".concat(t)}else"POST"===r&&(e.body=JSON.stringify(o),n["Content-Type"]="application/json");delete e.data,e.headers=n;let s=await fetch(i,e);return s},o=async t=>{let{address:e,offset:n,size:a,type:o,ticker:i}=t,s=await r("/ordx/GetAddressOrdxAssets",{data:{address:e,offset:n,size:a,type:o,ticker:i}});return s.json()},i=async t=>{let{ticker:e}=t,n=await r("/ordx/GetTickerSummary",{data:{ticker:e}});return n.json()},s=async t=>{let{ticker:e,offset:n,size:a,sort:o=0,type:i=1,address:s}=t,u=await r("/ordx/GetOrders",{data:{ticker:e,offset:n,size:a,sort:o,type:i,address:s}});return u.json()},u=async t=>{let{ticker:e,offset:n,size:a,sort:o=0,address:i}=t,s=await r("/ordx/GetHistory",{data:{ticker:e,offset:n,size:a,sort:o,address:i}});return s.json()},l=async t=>{let{interval:e=1,top_count:n=10,top_list:a="tx_amount"}=t,o=await r("/ordx/GetTopTickers",{data:{interval:e,top_count:n,top_list:a}});return o.json()},c=async t=>{let{address:e,raw:n}=t,a=await r("/ordx/SubmitOrder",{method:"POST",data:{address:e,raw:n}});return a.json()},d=async t=>{let{address:e,order_id:n}=t,a=await r("/ordx/CancelOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},p=async t=>{let{address:e,order_id:n}=t,a=await r("/ordx/LockOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},w=async t=>{let{address:e,order_id:n}=t,a=await r("/ordx/UnlockOrder",{method:"POST",data:{address:e,order_id:n}});return a.json()},f=async t=>{let{address:e,order_id:n,raw:a}=t,o=await r("/ordx/BuyOrder",{method:"POST",data:{address:e,order_id:n,raw:a}});return o.json()},h=async t=>{let{address:e,value:n=600,network:a}=t,r=await fetch("https://apitest.ordx.space/testnet/utxo/getUtxoByValue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e,value:n})});return r.json()},x=async t=>{let e=await fetch("testnet"===t?"https://mempool.space/testnet/api/v1/fees/recommended":"https://mempool.space/api/v1/fees/recommended"),n=await e.json();return n},m=async(t,e)=>{let n="https://mempool.space".concat("testnet"===e?"/testnet":"","/api/tx/").concat(t,"/hex"),a=await fetch(n).then(t=>t.text()).then(t=>{if("Transaction not found"===t)throw Error("Some error happened when finding BTC to pay. Please try again later.");return t});return a}},56690:function(t,e,n){n.d(e,{g:function(){return g},Us:function(){return d},eB:function(){return c},zU:function(){return S},NH:function(){return E},u4:function(){return y},$B:function(){return O},a:function(){return k},Ay:function(){return v}});var a=n(99301),r=n(81254),o=n(24128),i=n(33261),s=n(62478),u=n(40263).Buffer;let l=t=>{var e;let n=null===(e=o.Xf.fmt.toAsm(o.kL.toScriptPubKey(t)))||void 0===e?void 0:e[0];return n},c=async t=>{let{inscriptionUtxo:e,total:n,amount:o,network:i,address:u}=t,l=await (0,s.Oy)(e.txid,i),c=a.YW.fromHex(l);console.log(c);let d={hash:e.txid,index:e.vout,witnessUtxo:c.outs[e.vout],sighashType:131};console.log(d);let p=new a._B({network:"testnet"===i?a.QW.testnet:a.QW.bitcoin});a.Wi(r),console.log(u,n),p.addInput(d),p.addOutput({address:u,value:n});let w=await window.unisat.signPsbt(p.toHex());return w},d=async t=>{var e;let{orderId:n,feeRate:o,network:c,address:d,fee:p,utxos:w,serviceFee:f,dummyUtxos:h}=t;(0,i.env)("NEXT_PUBLIC_SERVICE_FEE");let x=(0,i.env)("NEXT_PUBLIC_IS_FREE"),m=(0,i.env)("NEXT_PUBLIC_SERVICE_ADDRESS");await (0,s.n3)({address:d,order_id:n});let y=await (0,s.xS)({address:d,order_id:n});if(!(null==y?void 0:null===(e=y.data)||void 0===e?void 0:e.raw))throw Error(y.msg);let{raw:v}=y.data;a.Wi(r);let g="testnet"===c?a.QW.testnet:a.QW.bitcoin,S=a._B.fromHex(v,{network:g}),E=new a._B({network:g});console.log(S);let O=w.reduce((t,e)=>t+e.value,0),k=w.map(t=>({hash:t.txid,index:t.vout,witnessUtxo:{script:u.from(l(d),"hex"),value:t.value}})),U=h.reduce((t,e)=>t+e.value,0),b=h.map(t=>({hash:t.txid,index:t.vout,witnessUtxo:{script:u.from(l(d),"hex"),value:t.value},sighashType:a.YW.SIGHASH_ALL}));b.forEach(t=>{E.addInput(t)}),E.addOutput({address:d,value:U}),console.log(k);let T={hash:S.txInputs[0].hash,index:S.txInputs[0].index,witnessUtxo:S.data.inputs[0].witnessUtxo,finalScriptWitness:S.data.inputs[0].finalScriptWitness};console.log(T),E.addInput(T),k.forEach(t=>{E.addInput(t)});let _=S.data.inputs[0].witnessUtxo.value;E.addOutput({address:d,value:_});let P=S.txOutputs[0].value,j=S.txOutputs[0];E.addOutput(j);let B=O-(P+p)-1200;"0"===x&&f&&m&&(B-=f,E.addOutput({address:m,value:f})),E.addOutput({address:d,value:600}),E.addOutput({address:d,value:600});let I={address:d,value:B};E.addOutput(I);let N=await window.unisat.signPsbt(E.toHex()),W=a._B.fromHex(N,{network:g}),A=W.extractTransaction(),C=A.toHex();return C};var p=n(51864),w=n.n(p),f=n(90555),h=n.n(f),x=n(34098),m=n.n(x);let y=t=>{let[e,n]=t.split(":");return{txid:e,vout:parseInt(n)}},v=t=>{t>=1e8&&(t*=10);let e=String(t).padStart(8,"0").slice(0,-9)+"."+String(t).padStart(8,"0").slice(-9);return"."==e.substring(0,1)&&(e="0"+e),e},g=t=>{let[e,n]=t.toString().split(".");return n||(n="0"),1e8*parseInt(e)+parseInt(n.padEnd(8,"0"))},S=function(t,e){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=w()(t,"value"),r=m()(a);n&&h()(r);let o=[],i=0;for(let t=0;t<r.length;t++){let n=r[t];if(o.push(n),(i+=n.value)>=e)break}return{minUtxo:a[0],maxUtxo:a[a.length-1],utxos:o,smallTwoUtxos:a.slice(0,2),total:i}},E=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*****";return"string"==typeof t&&t?"".concat(null==t?void 0:t.substring(0,e)).concat(n).concat(null==t?void 0:t.substring((null==t?void 0:t.length)-e)):""},O=t=>{let e={...t};return Object.keys(e).forEach(t=>{(""===e[t]||void 0===e[t]||null===e[t]||"null"===e[t]||"undefined"===e[t]||"NaN"===e[t]||isNaN(e[t])&&"number"==typeof e[t])&&delete e[t]}),e},k=(t,e)=>"testnet"===e?"https://mempool.space/testnet/tx/".concat(t):"https://mempool.space/tx/".concat(t)},68638:function(t,e,n){n.d(e,{Ee:function(){return u},JU:function(){return o},sD:function(){return s}});var a=n(94660),r=n(74810);let o=(0,a.Ue)()((0,r.mW)(t=>({list:[],add:e=>{t(t=>({list:[...t.list,e]}))},reset:()=>{t({list:[]})}}))),i={balance:{confirmed:0,unconfirmed:0,total:0},publicKey:"",address:"",unisat:null,connected:!1,installed:!1,network:"testnet"},s=(0,a.Ue)()((0,r.mW)((t,e)=>({...i,check:async()=>{try{let e=window.unisat;if(!e)throw t(t=>({installed:!1})),Error("Unisat not installed");t(t=>({installed:!0,unisat:e}));let n=await e.getAccounts();if(n.length){let a=n[0],r=await e.getNetwork(),o=await e.getPublicKey(),i=await e.getBalance();t(t=>({unisat:e,publicKey:o,address:a,balance:i,connected:!0,network:r}))}}catch(t){throw console.error("Error checking unisat",t),t}},connect:async()=>{try{let e=window.unisat;if(!e)throw Error("Unisat not installed");let n=await e.requestAccounts();if(n.length){let a=n[0],r=await e.getPublicKey(),o=await e.getNetwork(),i=await e.getBalance();t(t=>({publicKey:r,address:a,balance:i,connected:!0,network:o,unisat:e}))}}catch(t){throw console.error("Error checking unisat",t),t}},disconnect:()=>t(t=>({connected:!1,publicKey:"",address:"",balance:{confirmed:0,unconfirmed:0,total:0},unisat:null,installed:!0})),switchNetwork:async()=>{try{let n=window.unisat;if(!n)throw Error("Unisat not installed");let a="testnet"===e().network?"livenet":"testnet";await n.switchNetwork(a),t(t=>({network:a}));let r=await n.getAccounts();if(r.length){let e=r[0],a=await n.getPublicKey(),o=await n.getBalance();t(t=>({publicKey:a,address:e,balance:o,connected:!0,unisat:n}))}}catch(t){throw console.error("Error checking unisat",t),t}}}))),u=(0,a.Ue)()((0,r.mW)(t=>({feeRate:{value:1,type:"custom"},appVersion:0,setFeeRate:e=>{t({feeRate:e})},reset:()=>{t({feeRate:{value:1,type:"custom"},appVersion:0})}})))}}]);